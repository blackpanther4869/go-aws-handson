## 🚀 AWS構築＆Go開発ハンズオン - 非機能要件定義書

### 1. パフォーマンス要件

*   **画像アップロードからメタデータ抽出・永続化までの時間**:
    *   通常の画像（数MB程度）の場合、S3へのアップロード完了からDynamoDBへのメタデータ永続化までを**10秒以内**に完了することを目標とします。
    *   これは、LambdaのコールドスタートやS3イベントの伝播時間も考慮した、学習目的での現実的な目標値です。
*   **メタデータ検索APIの応答時間**:
    *   単一の`ImageID`または`FileName`による検索の場合、API Gatewayへのリクエストからレスポンス返却までを**1秒以内**に完了することを目標とします。
    *   期間指定による検索の場合、データ量に応じて変動しますが、**3秒以内**に完了することを目標とします。

### 2. セキュリティ要件

*   **最小権限の原則に基づくIAMロールの設定**:
    *   各Lambda関数には、その機能遂行に必要最小限の権限のみを付与したIAMロールを設定します。
        *   **署名付きURL発行Lambda**: S3への`PutObject`権限（署名付きURL発行のため）、CloudWatch Logsへの書き込み権限。
        *   **メタデータ抽出Lambda**: S3からの`GetObject`権限、DynamoDBへの`PutItem`権限、CloudWatch Logsへの書き込み権限。
        *   **メタデータ検索Lambda**: DynamoDBからの`GetItem`, `Query`権限、CloudWatch Logsへの書き込み権限。
*   **S3バケットのアクセス制御**:
    *   S3バケットは、パブリックアクセスをブロックし、IAMロールによるアクセスのみを許可します。
    *   バケットポリシーは、必要に応じて特定のAWSサービスからのアクセスを許可するように設定します。
*   **API Gatewayのエンドポイントセキュリティ**:
    *   API Gatewayのエンドポイントは、HTTPSを強制し、クライアントからのアクセスは署名付きURL発行およびメタデータ検索に限定します。
    *   認証・認可については、今回のハンズオンでは実装しませんが、本番環境ではCognitoやIAM認証などを検討します。

### 3. 可用性要件

*   **システムの稼働時間目標**:
    *   学習目的のため、特定のSLA（Service Level Agreement）は設定しませんが、AWSの各サービスのデフォルトの可用性に準拠します。
*   **障害発生時の復旧目標時間 (RTO) および復旧時点目標 (RPO)**:
    *   学習目的のため、特定のRTO/RPOは設定しません。

### 4. 運用・監視要件

*   **ログの収集・保存**:
    *   全てのLambda関数の実行ログは、CloudWatch Logsに自動的に収集・保存されます。
    *   ロググループはLambda関数ごとに自動生成され、保存期間はデフォルト設定（無期限）とします。
*   **メトリクス収集**:
    *   Lambdaの実行回数、エラー率、実行時間、DynamoDBのスループット（読み込み/書き込みキャパシティユニット使用率）などの標準メトリクスをCloudWatchで監視します。
*   **アラート設定**:
    *   学習目的のため、アラート設定は行いませんが、本番環境ではLambdaのエラー率上昇やDynamoDBのスロットリング発生時にアラートを発報するよう設定を検討します。

### 5. スケーラビリティ要件

*   **Lambdaの同時実行数**:
    *   デフォルトの同時実行数（アカウントレベルの制限）に準拠します。特定のピーク負荷を想定したチューニングは行いません。
*   **DynamoDBのキャパシティユニット**:
    *   オンデマンドキャパシティモードを使用し、自動的にスケーリングされるように設定します。これにより、無料枠の範囲内で柔軟なスケーリングを可能にします。

### 6. コスト要件

*   **AWS無料枠の範囲内での運用**:
    *   ハンズオン期間中は、可能な限りAWS無料枠の範囲内でサービスを利用します。
    *   特にS3は12ヶ月無料枠（または新しい無料プランのクレジット消費対象）であるため、利用量に注意します。
*   **ハンズオン終了後のリソースクリーンアップの徹底**:
    *   ハンズオン終了後、作成した全てのAWSリソース（S3バケット、DynamoDBテーブル、Lambda関数、API Gatewayなど）を完全に削除することを徹底します。これにより、不要な課金を防ぎます。